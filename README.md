## All code prototype from John Foley.